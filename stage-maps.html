<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stage Maps - RallyData Pro</title>
    <meta
      name="description"
      content="Interactive WRC stage maps, elevation profiles, hazard analysis, and detailed route information."
    />
    <link rel="stylesheet" href="css/styles.css" />
    <style>
      .map-container {
        background: #000;
        border-radius: 15px;
        height: 400px;
        position: relative;
        overflow: hidden;
        margin-bottom: 30px;
        border: 2px solid #333;
      }

      .map-svg {
        width: 100%;
        height: 100%;
      }

      .stage-path {
        stroke: #ff6b35;
        stroke-width: 3;
        fill: none;
        filter: drop-shadow(0 0 5px #ff6b35);
      }

      .waypoint {
        fill: #f7931e;
        stroke: #fff;
        stroke-width: 2;
      }

      .waypoint.start {
        fill: #00ff00;
      }

      .waypoint.finish {
        fill: #ff0000;
      }

      .hazard {
        fill: #ff4757;
        stroke: #fff;
        stroke-width: 1;
        animation: pulse 2s infinite;
      }

      .map-controls {
        position: absolute;
        top: 15px;
        right: 15px;
        display: flex;
        gap: 10px;
        z-index: 10;
      }

      .map-btn {
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
        border: 1px solid #ff6b35;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .map-btn:hover,
      .map-btn.active {
        background: #ff6b35;
      }

      .elevation-profile {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.1),
          rgba(255, 255, 255, 0.05)
        );
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 30px;
      }

      .elevation-chart {
        background: #000;
        height: 200px;
        border-radius: 10px;
        position: relative;
        overflow: hidden;
      }

      .elevation-line {
        stroke: #ff6b35;
        stroke-width: 2;
        fill: url(#elevationGradient);
      }

      .stage-details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
      }

      .detail-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .detail-card h4 {
        color: #ff6b35;
        margin-bottom: 15px;
        font-size: 1.1rem;
      }

      .detail-list {
        list-style: none;
      }

      .detail-list li {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .detail-list li:last-child {
        border-bottom: none;
      }

      .hazard-map {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 15px;
        padding: 25px;
        margin: 30px 0;
      }

      .hazard-legend {
        display: flex;
        gap: 30px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        border: 2px solid #fff;
      }

      .legend-color.jump {
        background: #ff4757;
      }
      .legend-color.chicane {
        background: #ffa502;
      }
      .legend-color.hairpin {
        background: #ff6b35;
      }
      .legend-color.bridge {
        background: #5352ed;
      }

      .stage-selector-section {
        background: linear-gradient(
          135deg,
          rgba(255, 107, 53, 0.1),
          rgba(247, 147, 30, 0.05)
        );
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 40px;
      }

      .stage-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .stage-card {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
      }

      .stage-card:hover,
      .stage-card.active {
        border-color: #ff6b35;
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(255, 107, 53, 0.2);
      }

      .stage-card h4 {
        color: #ff6b35;
        margin-bottom: 10px;
      }

      .stage-info-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 14px;
      }

      .weather-overlay {
        position: absolute;
        bottom: 15px;
        left: 15px;
        background: rgba(0, 0, 0, 0.8);
        padding: 15px;
        border-radius: 10px;
        min-width: 200px;
      }

      .weather-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
      }

      .surface-indicator {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: bold;
        text-transform: uppercase;
      }

      .surface-indicator.tarmac {
        background: #666;
        color: #fff;
      }

      .surface-indicator.gravel {
        background: #d4a574;
        color: #000;
      }

      .surface-indicator.snow {
        background: #e3f2fd;
        color: #1976d2;
      }

      .surface-indicator.mixed {
        background: linear-gradient(45deg, #666 50%, #d4a574 50%);
        color: #fff;
      }

      @media (max-width: 768px) {
        .map-container {
          height: 300px;
        }

        .stage-grid {
          grid-template-columns: 1fr;
        }

        .hazard-legend {
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav class="container">
        <div class="logo"><a href="index.html">RallyData Pro</a></div>
        <ul class="nav-links">
          <li><a href="live-timing.html">Live Timing</a></li>
          <li><a href="stage-maps.html" class="active">Stage Maps</a></li>
          <li><a href="analytics.html">Analytics</a></li>
          <li><a href="calendar.html">Calendar</a></li>
          <li><a href="weather.html">Weather</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section class="page-header">
        <div class="container">
          <h1>Interactive Stage Maps</h1>
          <p>
            Detailed route analysis, elevation profiles, hazard mapping, and
            comprehensive stage information
          </p>
        </div>
      </section>

      <section class="section-padding">
        <div class="container">
          <div class="stage-selector-section">
            <h2>Select Stage</h2>
            <div class="stage-grid">
              <div class="stage-card active" data-stage="ss12">
                <h4>SS12 - Col de Turini</h4>
                <div class="stage-info-row">
                  <span>Distance:</span>
                  <span>11.76 km</span>
                </div>
                <div class="stage-info-row">
                  <span>Surface:</span>
                  <span class="surface-indicator mixed">Mixed</span>
                </div>
                <div class="stage-info-row">
                  <span>Elevation:</span>
                  <span>1,145m - 620m</span>
                </div>
              </div>

              <div class="stage-card" data-stage="ss11">
                <h4>SS11 - Peille - Peira Cava</h4>
                <div class="stage-info-row">
                  <span>Distance:</span>
                  <span>18.82 km</span>
                </div>
                <div class="stage-info-row">
                  <span>Surface:</span>
                  <span class="surface-indicator tarmac">Tarmac</span>
                </div>
                <div class="stage-info-row">
                  <span>Elevation:</span>
                  <span>412m - 1,450m</span>
                </div>
              </div>

              <div class="stage-card" data-stage="ss10">
                <h4>SS10 - La Bollène-Vésubie</h4>
                <div class="stage-info-row">
                  <span>Distance:</span>
                  <span>23.25 km</span>
                </div>
                <div class="stage-info-row">
                  <span>Surface:</span>
                  <span class="surface-indicator mixed">Mixed</span>
                </div>
                <div class="stage-info-row">
                  <span>Elevation:</span>
                  <span>850m - 1,210m</span>
                </div>
              </div>

              <div class="stage-card" data-stage="ss9">
                <h4>SS9 - Roure - Beuil</h4>
                <div class="stage-info-row">
                  <span>Distance:</span>
                  <span>16.24 km</span>
                </div>
                <div class="stage-info-row">
                  <span>Surface:</span>
                  <span class="surface-indicator tarmac">Tarmac</span>
                </div>
                <div class="stage-info-row">
                  <span>Elevation:</span>
                  <span>600m - 1,380m</span>
                </div>
              </div>
            </div>
          </div>

          <div class="map-container">
            <div class="map-controls">
              <button class="map-btn active" data-layer="route">Route</button>
              <button class="map-btn" data-layer="hazards">Hazards</button>
              <button class="map-btn" data-layer="sectors">Sectors</button>
              <button class="map-btn" data-layer="weather">Weather</button>
            </div>

            <svg
              class="map-svg"
              viewBox="0 0 800 400"
              xmlns="http://www.w3.org/2000/svg"
            >
              <defs>
                <linearGradient
                  id="pathGradient"
                  x1="0%"
                  y1="0%"
                  x2="100%"
                  y2="0%"
                >
                  <stop
                    offset="0%"
                    style="stop-color: #00ff00; stop-opacity: 1"
                  />
                  <stop
                    offset="100%"
                    style="stop-color: #ff0000; stop-opacity: 1"
                  />
                </linearGradient>
              </defs>

              <!-- Stage route path -->
              <path
                class="stage-path"
                d="M50 300 Q150 250 200 200 T350 150 Q450 120 550 140 T700 180 Q750 200 780 220"
              />

              <!-- Waypoints -->
              <circle class="waypoint start" cx="50" cy="300" r="8" />
              <circle class="waypoint" cx="200" cy="200" r="6" />
              <circle class="waypoint" cx="350" cy="150" r="6" />
              <circle class="waypoint" cx="550" cy="140" r="6" />
              <circle class="waypoint" cx="700" cy="180" r="6" />
              <circle class="waypoint finish" cx="780" cy="220" r="8" />

              <!-- Hazards (initially hidden) -->
              <g class="hazard-layer" style="display: none">
                <circle class="hazard jump" cx="180" cy="210" r="5" />
                <circle class="hazard chicane" cx="320" cy="160" r="5" />
                <circle class="hazard hairpin" cx="500" cy="135" r="5" />
                <circle class="hazard bridge" cx="650" cy="170" r="5" />
              </g>

              <!-- Sector markers -->
              <g class="sector-layer" style="display: none">
                <line
                  x1="200"
                  y1="180"
                  x2="200"
                  y2="220"
                  stroke="#ffa502"
                  stroke-width="3"
                />
                <text x="205" y="200" fill="#ffa502" font-size="14">S1</text>

                <line
                  x1="550"
                  y1="120"
                  x2="550"
                  y2="160"
                  stroke="#ffa502"
                  stroke-width="3"
                />
                <text x="555" y="140" fill="#ffa502" font-size="14">S2</text>
              </g>

              <!-- Labels -->
              <text
                x="30"
                y="290"
                fill="#00ff00"
                font-size="14"
                font-weight="bold"
              >
                START
              </text>
              <text
                x="740"
                y="210"
                fill="#ff0000"
                font-size="14"
                font-weight="bold"
              >
                FINISH
              </text>
            </svg>

            <div
              class="weather-overlay"
              id="weatherOverlay"
              style="display: none"
            >
              <div class="weather-item">
                <span>Temperature:</span>
                <span>12°C</span>
              </div>
              <div class="weather-item">
                <span>Conditions:</span>
                <span>Light Rain</span>
              </div>
              <div class="weather-item">
                <span>Road Temp:</span>
                <span>8°C</span>
              </div>
              <div class="weather-item">
                <span>Grip:</span>
                <span>Medium</span>
              </div>
            </div>
          </div>

          <div class="elevation-profile">
            <h3>Elevation Profile - SS12 Col de Turini</h3>
            <div class="elevation-chart">
              <svg width="100%" height="100%" viewBox="0 0 800 200">
                <defs>
                  <linearGradient
                    id="elevationGradient"
                    x1="0%"
                    y1="0%"
                    x2="0%"
                    y2="100%"
                  >
                    <stop
                      offset="0%"
                      style="stop-color: #ff6b35; stop-opacity: 0.8"
                    />
                    <stop
                      offset="100%"
                      style="stop-color: #ff6b35; stop-opacity: 0.1"
                    />
                  </linearGradient>
                </defs>

                <path
                  class="elevation-line"
                  d="M0 50 L100 40 L200 45 L300 60 L400 80 L500 90 L600 110 L700 130 L800 150"
                />

                <!-- Elevation markers -->
                <g fill="#ccc" font-size="12">
                  <text x="10" y="40">1145m</text>
                  <text x="200" y="35">1050m</text>
                  <text x="400" y="70">950m</text>
                  <text x="600" y="100">800m</text>
                  <text x="780" y="140">620m</text>
                </g>

                <!-- Distance markers -->
                <g fill="#888" font-size="10">
                  <text x="0" y="190">0km</text>
                  <text x="200" y="190">3km</text>
                  <text x="400" y="190">6km</text>
                  <text x="600" y="190">9km</text>
                  <text x="760" y="190">11.76km</text>
                </g>
              </svg>
            </div>
          </div>

          <div class="hazard-map">
            <h3>Hazard Analysis</h3>
            <div class="hazard-legend">
              <div class="legend-item">
                <div class="legend-color jump"></div>
                <span>Jump/Crest</span>
              </div>
              <div class="legend-item">
                <div class="legend-color chicane"></div>
                <span>Chicane</span>
              </div>
              <div class="legend-item">
                <div class="legend-color hairpin"></div>
                <span>Hairpin Turn</span>
              </div>
              <div class="legend-item">
                <div class="legend-color bridge"></div>
                <span>Bridge/Narrow</span>
              </div>
            </div>

            <div class="stage-details-grid">
              <div class="detail-card">
                <h4>Stage Characteristics</h4>
                <ul class="detail-list">
                  <li><span>Total Distance</span><span>11.76 km</span></li>
                  <li><span>Average Width</span><span>6.2 m</span></li>
                  <li><span>Max Gradient</span><span>12.5%</span></li>
                  <li><span>Corners (90°+)</span><span>23</span></li>
                  <li><span>Hairpins</span><span>7</span></li>
                  <li><span>Jumps/Crests</span><span>4</span></li>
                </ul>
              </div>

              <div class="detail-card">
                <h4>Safety Information</h4>
                <ul class="detail-list">
                  <li><span>Medical Posts</span><span>3</span></li>
                  <li><span>Rescue Points</span><span>5</span></li>
                  <li><span>Radio Zones</span><span>8</span></li>
                  <li><span>Spectator Areas</span><span>12</span></li>
                  <li><span>Danger Zones</span><span>6</span></li>
                  <li><span>Speed Limits</span><span>80 km/h</span></li>
                </ul>
              </div>

              <div class="detail-card">
                <h4>Technical Data</h4>
                <ul class="detail-list">
                  <li>
                    <span>Surface Type</span><span>60% Tarmac, 40% Gravel</span>
                  </li>
                  <li><span>Grip Level</span><span>Variable</span></li>
                  <li><span>Tire Compound</span><span>Soft Mixed</span></li>
                  <li><span>Fuel Usage</span><span>High</span></li>
                  <li><span>Brake Stress</span><span>Extreme</span></li>
                  <li><span>Setup Bias</span><span>Stability</span></li>
                </ul>
              </div>

              <div class="detail-card">
                <h4>Weather Impact</h4>
                <ul class="detail-list">
                  <li><span>Current Temp</span><span>12°C</span></li>
                  <li><span>Road Surface</span><span>Wet Patches</span></li>
                  <li><span>Visibility</span><span>Good</span></li>
                  <li><span>Wind Effect</span><span>Low</span></li>
                  <li><span>Rain Forecast</span><span>Light Showers</span></li>
                  <li><span>Grip Prediction</span><span>Decreasing</span></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>Stage Data</h3>
            <a href="stage-maps.html">Interactive Maps</a>
            <a href="analytics.html">Route Analysis</a>
            <a href="weather.html">Weather Conditions</a>
            <a href="live-timing.html">Live Progress</a>
          </div>
          <div class="footer-section">
            <h3>Championships</h3>
            <a href="#">WRC</a>
            <a href="#">WRC2</a>
            <a href="#">WRC3</a>
            <a href="#">Junior WRC</a>
          </div>
          <div class="footer-section">
            <h3>Data Partners</h3>
            <a href="#">Official WRC API</a>
            <a href="#">Weather Services</a>
            <a href="#">Mapping Data</a>
            <a href="#">Team Partnerships</a>
          </div>
          <div class="footer-section">
            <h3>Support</h3>
            <a href="#">API Documentation</a>
            <a href="#">Contact</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms of Service</a>
          </div>
        </div>
        <div class="footer-bottom">
          <p>
            &copy; 2025 RallyData Pro. Interactive WRC stage mapping and
            analysis platform.
          </p>
        </div>
      </div>
    </footer>

    <script src="js/common.js"></script>
    <script>
      // Stage map functionality
      class StageMapper {
        constructor() {
          this.currentStage = "ss12";
          this.currentLayer = "route";
          this.initializeControls();
        }

        initializeControls() {
          // Stage selection
          document.querySelectorAll(".stage-card").forEach((card) => {
            card.addEventListener("click", (e) => {
              document
                .querySelectorAll(".stage-card")
                .forEach((c) => c.classList.remove("active"));
              card.classList.add("active");
              this.currentStage = card.dataset.stage;
              this.loadStage(this.currentStage);
            });
          });

          // Map layer controls
          document.querySelectorAll(".map-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              document
                .querySelectorAll(".map-btn")
                .forEach((b) => b.classList.remove("active"));
              btn.classList.add("active");
              this.currentLayer = btn.dataset.layer;
              this.showLayer(this.currentLayer);
            });
          });
        }

        loadStage(stageId) {
          // Simulate loading different stage data
          const stageData = {
            ss12: {
              name: "Col de Turini",
              distance: "11.76 km",
              surface: "Mixed",
              elevation: "1,145m - 620m",
            },
            ss11: {
              name: "Peille - Peira Cava",
              distance: "18.82 km",
              surface: "Tarmac",
              elevation: "412m - 1,450m",
            },
            ss10: {
              name: "La Bollène-Vésubie",
              distance: "23.25 km",
              surface: "Mixed",
              elevation: "850m - 1,210m",
            },
            ss9: {
              name: "Roure - Beuil",
              distance: "16.24 km",
              surface: "Tarmac",
              elevation: "600m - 1,380m",
            },
          };

          const stage = stageData[stageId];
          if (stage) {
            // Update elevation profile title
            const profileTitle = document.querySelector(
              ".elevation-profile h3"
            );
            profileTitle.textContent = `Elevation Profile - ${stageId.toUpperCase()} ${
              stage.name
            }`;

            // Animate route change
            this.animateRouteChange();
          }
        }

        showLayer(layer) {
          // Hide all layers first
          document
            .querySelectorAll(".hazard-layer, .sector-layer")
            .forEach((l) => {
              l.style.display = "none";
            });
          document.getElementById("weatherOverlay").style.display = "none";

          // Show selected layer
          switch (layer) {
            case "hazards":
              document.querySelector(".hazard-layer").style.display = "block";
              break;
            case "sectors":
              document.querySelector(".sector-layer").style.display = "block";
              break;
            case "weather":
              document.getElementById("weatherOverlay").style.display = "block";
              this.updateWeatherData();
              break;
          }
        }

        animateRouteChange() {
          const path = document.querySelector(".stage-path");
          path.style.strokeDasharray = path.getTotalLength();
          path.style.strokeDashoffset = path.getTotalLength();
          path.animate(
            [
              { strokeDashoffset: path.getTotalLength() },
              { strokeDashoffset: 0 },
            ],
            {
              duration: 2000,
              easing: "ease-out",
            }
          );
        }

        updateWeatherData() {
          const weatherData =
            RallyDataPro.LiveDataSimulator.prototype.generateWeatherData();
          const weatherItems = document.querySelectorAll(
            "#weatherOverlay .weather-item span:last-child"
          );

          if (weatherItems.length >= 4) {
            weatherItems[0].textContent = `${weatherData.temperature}°C`;
            weatherItems[1].textContent = weatherData.conditions;
            weatherItems[2].textContent = `${weatherData.temperature - 4}°C`;
            weatherItems[3].textContent = weatherData.conditions.includes(
              "Rain"
            )
              ? "Low"
              : "Medium";
          }
        }
      }

      // Initialize stage mapper when page loads
      document.addEventListener("DOMContentLoaded", () => {
        new StageMapper();
      });
    </script>
  </body>
</html>
